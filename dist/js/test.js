!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e}r.r(t);var f={rotate:/^rotate$/,scale:/^scale$/,dragMove2:/^dragMove2$/,dragStart:/^dragStart$/,dragMove:/^dragMove$/,dragEnd:/^dragEnd$/,unClick:/^unClick$/,click:/^click$/},d=function(){function e(t,r){_(this,e),this._activated_listener={},this._registered_listener={rotate:null,scale:null,dragMove:null,dragStart:null,dragEnd:null,dragMove2:null,click:null,unClick:null,keyDown:{_parts:[],_reference:0},keyUp:{_reference:0},keyPress:{_reference:0}},this._bm=1,this.target=null,this._listener_options=void 0,this._listener_status={},this._points=[],this._identifiers=[],this.target=t,this._listener_options=r}return u(e,[{key:"setListener",value:function(e){for(var t in e)if(!this._listener_status[t]!=!e[t]){var r=y.EVENT_CONFIG[t],n=r[0],i=r[1],s=r[2]||this.target;e[t]?s.addEventListener(n,this[i],this._listener_options):s.removeEventListener(n,this[i],this._listener_options),this._listener_status[t]=!!e[t]}}},{key:"eventDispenser",value:function(e,t){if(this._identifiers[0]===y.MOUSE_EVENT_ID)Math.pow(2,e.button)&this._bm&&t(e,e,0);else if(e.changedTouches)for(var r=0;r<e.changedTouches.length;r++){var n=this._identifiers.indexOf(e.changedTouches[r].identifier);-1!==n&&t(e,e.changedTouches[r],n)}}},{key:"_is_mouse_event",get:function(){return this._identifiers[0]===y.MOUSE_EVENT_ID}}]),e}();d.EVENT_CONFIG={MOUSE_DOWN:["mousedown","cursorDown"],MOUSE_MOVE:["mousemove","cursorMove",window],MOUSE_UP:["mouseup","cursorUp",window],TOUCH_START:["touchstart","cursorDown"],TOUCH_MOVE:["touchmove","cursorMove",window],TOUCH_END:["touchend","cursorUp",window],TOUCH_CANCEL:["touchcancel","cursorUp",window],KEY_DOWN:["keydown","keyDown"],KEY_UP:["keyup","keyUp"],KEY_PRESS:["keypress","keyPress"]},d.CURSOR_EVENT_HANDLES=Object.keys(f),d.STATES={IS_DRAG:1,IS_ROTATE:2,IS_SCALE:4,MOUSE_DOWN:"MOUSE_DOWN",MOUSE_MOVE:"MOUSE_MOVE",MOUSE_UP:"MOUSE_UP",TOUCH_START:"TOUCH_START",TOUCH_MOVE:"TOUCH_MOVE",TOUCH_END:"TOUCH_END",TOUCH_CANCEL:"TOUCH_CANCEL",KEY_DOWN:"KEY_DOWN",KEY_UP:"KEY_UP",KEY_PRESS:"KEY_PRESS"},d.PATTERN_MAP=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},f,{},{keyDown:/^\S+_keyDown$/,keyUp:/^\S+_keyUp$/,keyPress:/^\S+_keyPress$/}),d.MOUSE_EVENT_ID=-9007199254740991,d._PRIVATE_METHODS={update_key_listener:function(e,t,r,n){y._PRIVATE_METHODS.match_keys(t,(function(t){var i=e[t];i||(i=e[t]=[]);var s=i.indexOf(r);n?s>=0&&(e._reference--,i.length>1?i.splice(s,1):delete e[t]):(e._reference++,~s||i.push(r))}))},match_keys:function(e,t){var r=e.match(/(\w+?|\ )(?=$|\||\,|\+)/g);if(r=r?r.map((function(e){return e.toLocaleLowerCase()})):[],!t)return r;var n=r,i=Array.isArray(n),s=0;for(n=i?n:n[Symbol.iterator]();;){var o;if(i){if(s>=n.length)break;o=n[s++]}else{if((s=n.next()).done)break;o=s.value}if(t(o))break}},get_keys:function(e){return e.code&&e.key!==e.code?[e.key.toLocaleLowerCase(),e.code.toLocaleLowerCase()]:[e.key.toLocaleLowerCase()]}},d._LISTENER_PREPROCESSOR={keyDown:function(e,t,r){var n,i=e.slice(0,-8).split(","),s=r?function(e,r,n){if(n){var i=e[r];if(i){var s=i._listeners.indexOf(t);-1!==s&&(i._listeners.splice(s,1),function e(t){var r=t._parent;--t._reference<=0&&r&&(delete r[t._key],e(r))}(i))}}}:function(e,r,i){var s=e[r];s||((s=e[r]={_parent:e,_key:r,_reference:0,_parts:e._parts.concat(r)})._path=s._parts.join("+"),e._reference++),n.push(s),i&&(s._reference++,s._listeners?-1===s._listeners.indexOf(t)&&s._listeners.push(t):s._listeners=[t])};i.forEach((function(e){n=[this._registered_listener.keyDown],e.split("+").forEach((function(e,t,r){var i=n,o=y._PRIVATE_METHODS.match_keys(e),a=r.length===t+1;n=[];var c=i,_=Array.isArray(c),l=0;for(c=_?c:c[Symbol.iterator]();;){var u;if(_){if(l>=c.length)break;u=c[l++]}else{if((l=c.next()).done)break;u=l.value}var f=u,d=o,p=Array.isArray(d),v=0;for(d=p?d:d[Symbol.iterator]();;){var h;if(p){if(v>=d.length)break;h=d[v++]}else{if((v=d.next()).done)break;h=v.value}s(f,h,a)}}}),this)}),this)},keyUp:function(e,t,r){y._PRIVATE_METHODS.update_key_listener(this._registered_listener.keyUp,e,t,r)},keyPress:function(e,t,r){y._PRIVATE_METHODS.update_key_listener(this._registered_listener.keyPress,e,t,r)}};var y=function(e){function t(e,r,n){var i;return _(this,t),(i=o(this,a(t).call(this,e,n)))._mesh_value=4*(window.devicePixelRatio||1),i._process_status=0,i._process_values={kd_tasks:[]},i.cursorDown=function(e){var r,n=i._points;if(i._identifiers[0]!==t.MOUSE_EVENT_ID)if(e.changedTouches&&n.length<i._max_points){var s=e.changedTouches,o=Array.isArray(s),a=0;for(s=o?s:s[Symbol.iterator]();;){var c;if(o){if(a>=s.length)break;c=s[a++]}else{if((a=s.next()).done)break;c=a.value}var _=c;if(-1===i._identifiers.indexOf(_.identifier)){r=_;break}}}else 0===n.length&&Math.pow(2,e.button)&i._bm&&(r=e);if(r){var l=t.CURSOR_EVENT_HANDLES.length;if(0===n.length){var u=i._registered_listener,f=u.dragStart&&u.dragStart(e,r)||!1;if(!0===f)return;l=0,t.CURSOR_EVENT_HANDLES.reduce((function(e,t){return u[t]&&(!1===f||~f.indexOf(t))?(l++,e[t]=u[t]):delete e[t],e}),i._activated_listener)}(l>1||l>0&&!activated_listener.dragStart)&&i._registPoint(e,r)}},i._move=function(e,t,r){var n=i._activated_listener,s=i._points[r];if(n.dragMove){var o={x:t.clientX-s.mx,y:t.clientY-s.my};n.dragMove(e,o)?(s.mx=t.clientX-o.x,s.my=t.clientY-o.y):(s.mx=t.clientX,s.my=t.clientY)}n.click&&Math.abs(t.clientX-s.dx)+Math.abs(t.clientY-s.dy)>i._mesh_value&&(n.click=!1,n.unClick&&n.unClick(e,t))},i._pinch=function(e,r,n){var s=t.STATES,o=i._activated_listener,a=i._process_values,c=i._points,_=c[n],l=c[1===n?0:1],u=r.clientX-_.mx,f=r.clientY-_.my;if(o.dragMove2){var d={x:u/2,y:f/2};o.dragMove2(e,d)&&(u-=2*d.x,f-=2*d.y)}_.mx=_.mx+u,_.my=_.my+f;var y=(_.mx+l.mx)/2,p=(_.my+l.my)/2;if(o.scale){var v=Math.sqrt(Math.pow(_.mx-l.mx,2)+Math.pow(_.my-l.my,2));i._process_status&s.IS_SCALE?o.scale(e,-(a.sd-(a.sd=v))):Math.abs(v-a.sd)>i._mesh_value&&(i._process_status|=s.IS_SCALE,o.scale(e,-(a.sd-(a.sd=v)),{x:y,y:p}))}if(o.rotate){var h=0===n?1:n,E=c[0].mx-c[h].mx,O=c[0].my-c[h].my,k=Math.atan2(O,E);k*a.ra<=0&&(a.ra=-a.ra),i._process_status&s.IS_ROTATE?(o.rotate(e,k-a.ra),a.ra=k):Math.abs(k-a.ra)>.01*Math.PI&&(i._process_status|=s.IS_ROTATE,o.rotate(e,k-a.ra,{x:y,y:p}),a.ra=k)}},i.cursorMove=function(e){i.eventDispenser(e,i._points.length<2?i._move:i._pinch)},i._leave=function(e,r,n){var o;i._identifiers.splice(n,1),i._points.splice(n,1);var a=t.STATES,c=i._identifiers.length,_=i._activated_listener;switch(!0){case c<1:i.setListener((s(o={},a.MOUSE_DOWN,!0),s(o,a.MOUSE_MOVE,!1),s(o,a.MOUSE_UP,!1),s(o,a.TOUCH_MOVE,!1),s(o,a.TOUCH_END,!1),s(o,a.TOUCH_CANCEL,!1),o)),i._process_status=0,_.dragEnd&&_.dragEnd(e,r),_.click&&_.click(e,r);break;case c<i._max_points:if(i._process_status=a.IS_DRAG,e.targetTouches&&e.targetTouches.length>=i._max_points){var l=e.targetTouches,u=Array.isArray(l),f=0;for(l=u?l:l[Symbol.iterator]();;){var d;if(u){if(f>=l.length)break;d=l[f++]}else{if((f=l.next()).done)break;d=f.value}var y=d;if(-1===i._identifiers.indexOf(y.identifier)){i._registPoint(e,y);break}}}}},i.cursorUp=function(e){i.eventDispenser(e,i._leave)},i.keyDown=function(e){var r=i._process_values.kd_tasks;function n(t){if(t){for(var n=t._listeners?t._listeners.length:0,i=0;i<n;i++)if(!0===t._listeners[i](e,t._path))return!0;t._reference>n&&-1===r.indexOf(t)&&r.push(t)}}var s=t._PRIVATE_METHODS.get_keys(e);if(!r.some((function(e){return s.some((function(t){return n(e[t])}))}))){var o=s,a=Array.isArray(o),c=0;for(o=a?o:o[Symbol.iterator]();;){var _;if(a){if(c>=o.length)break;_=o[c++]}else{if((c=o.next()).done)break;_=c.value}var l=_;if(n(i._registered_listener.keyDown[l]))break}}},i.keyUp=function(e){for(var r=t._PRIVATE_METHODS.get_keys(e),n=i._process_values.kd_tasks,s=function(e){r.some((function(t){return-1!==n[e]._parts.indexOf(t)}))&&n.splice(e--,1),o=e},o=0;o<n.length;o++)s(o);var a=i._registered_listener.keyUp,c=r,_=Array.isArray(c),l=0;for(c=_?c:c[Symbol.iterator]();;){var u;if(_){if(l>=c.length)break;u=c[l++]}else{if((l=c.next()).done)break;u=l.value}var f=u;a[f]&&a[f].some((function(t){return t(e)}))}},i.keyPress=function(e){var r=t._PRIVATE_METHODS.get_keys(e),n=i._registered_listener.keyPress,s=r,o=Array.isArray(s),a=0;for(s=o?s:s[Symbol.iterator]();;){var c;if(o){if(a>=s.length)break;c=s[a++]}else{if((a=s.next()).done)break;c=a.value}var _=c;n[_]&&n[_].some((function(t){return t(e)}))}},i.registListener(r),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,e),u(t,[{key:"updateListener",value:function(e,r){var n,i=this._registered_listener,o=t.STATES;if(e)for(var a in e)for(var c in t.PATTERN_MAP)t.PATTERN_MAP[c].test(a)&&(t._LISTENER_PREPROCESSOR[c]?e[a]&&t._LISTENER_PREPROCESSOR[c].call(this,a,e[a],r):i[c]=r?null:e[a]);this._max_points=i.scale||i.rotate||i.dragMove2?2:1;var _=!!(i.dragStart||i.dragMove||i.dragMove2||i.dragEnd||i.click||i.scale||i.rotate);this.setListener((s(n={},o.MOUSE_DOWN,_),s(n,o.TOUCH_START,_),s(n,o.KEY_DOWN,i.keyDown._reference>0),s(n,o.KEY_UP,i.keyDown._reference>0||i.keyUp._reference>0),s(n,o.KEY_PRESS,i.keyPress._reference>0),n))}},{key:"_registPoint",value:function(e,r){var n,i=t.STATES,o=this._points,a=this._activated_listener;switch(o.push({dx:r.clientX,dy:r.clientY,mx:r.clientX,my:r.clientY}),this._identifiers.push(isNaN(r.identifier)?t.MOUSE_EVENT_ID:r.identifier),o.length){case 1:this._process_status=i.IS_DRAG;var c=this._is_mouse_event;this.setListener((s(n={},i.MOUSE_DOWN,c),s(n,i.MOUSE_MOVE,c),s(n,i.MOUSE_UP,c),s(n,i.TOUCH_MOVE,!c),s(n,i.TOUCH_END,!c),s(n,i.TOUCH_CANCEL,!c),n));break;case 2:this._process_values.sd=Math.sqrt(Math.pow(o[0].mx-o[1].mx,2)+Math.pow(o[0].my-o[1].my,2)),this._process_values.ra=Math.atan2(o[0].my-o[1].my,o[0].mx-o[1].mx),a.click&&(a.click=!1),a.unClick&&(a.unClick(e,r),delete a.unClick)}}},{key:"registListener",value:function(e){this.updateListener(e)}},{key:"removeListener",value:function(e){e&&this.updateListener(e,!0)}},{key:"stopListener",value:function(){var e=this;this.setListener(Object.keys(this._listener_status).reduce((function(t,r){return e._listener_status[r]&&(t[r]=!1),t}),{}))}}]),t}(d);try{window.InputListener=y}catch(e){}t.default=y},function(e,t,r){"use strict";r.r(t);var n=r(0);s(test_view1),s(test_view2);var i=0;function s(e){var t,r=0,s=1,o=0,a=0,c=e.querySelector("#text_view");function _(e,t){o+=t.x,a+=t.y,l()}function l(){t||(t=window.requestAnimationFrame(u))}function u(){t=null,e.style.transform="translate(".concat(o,"px,").concat(a,"px) rotate(").concat(r,"deg) scale(").concat(s,")")}function f(e){var t=document.createElement("li");t.style.cssText="display:block;width:100%;",t.innerHTML=e,c.firstChild?c.insertBefore(t,c.firstChild):c.appendChild(t)}var d=new n.default(e,{dragStart:function(t){t.preventDefault(),e.style.boxShadow="0 0 4px black",e.style.zIndex=++i,e.focus()},dragEnd:function(t){e.style.boxShadow=""},dragMove:_,dragMove2:_,scale:function(t,r,n){n&&console.log("scale",n),s*=1+r/(e.clientWidth*s),l()},rotate:function(e,t,n){n&&console.log("rotate",n),r+=180*t/Math.PI,l()},click:function(e){e.preventDefault(),console.log("click->",e)},unClick:function(e){return console.log("unClick->",e)},"alt|ArrowUp+a,arrowup+a|z+s|x+d|c,s,d+f,f,d_keyDown":function(e,t){c&&f("keyDown:".concat(t)),console.log("keyDown",e,t)},"s,1,f_keyUp":function(e){c&&f("keyUp:".concat(e.code||e.key)),console.log("keyUp",e)},"s,d,e_keyPress":function(e){c&&f("keyPress:".concat(e.code||e.key)),console.log("keyPress",e)},"1,2,3,4,5,6_keyPress":function(e){c&&f("keyPress:".concat(e.code)),console.log("keyPress",e)}});console.log(d)}}]);